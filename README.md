# ğŸƒ ë°©íƒˆì¶œ ì˜ˆì•½ ì‹œìŠ¤í…œ

ìš°ì•„í•œ ë°©íƒˆì¶œ ì¹´í˜ì˜ ì˜ˆì•½ ì‹œìŠ¤í…œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì…ë‹ˆë‹¤.

## ğŸ’ ì†ë‹˜

ì†ë‹˜ì€ íšŒì›ê°€ì… í›„ ì›í•˜ëŠ” í…Œë§ˆ, ë‚ ì§œ, ì‹œê°„ ì„ ì„ íƒí•˜ì—¬ ë°©íƒˆì¶œì„ ì˜ˆì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì˜ˆì•½

ì˜ˆì•½ì„ í•  ë•ŒëŠ” í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì‹œìŠ¤í…œì˜ ê°„í¸ê²°ì œ ë°©ì‹ì„ í†µí•´ ê²°ì œë¥¼ í•´ì•¼ ì˜ˆì•½ì´ ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬ ë©ë‹ˆë‹¤.

> #### â— ì‹¤ì œì™€ ë™ì¼í•œ ê²°ì œ ë°©ì‹ì´ ì‚¬ìš©ë˜ì§€ë§Œ ì‹¤ì œë¡œ ê²°ì œê°€ ë˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.

### ì˜ˆì•½ ëŒ€ê¸°

ë§Œì•½ ì´ë¯¸ ì˜ˆì•½ì´ ë˜ì–´ ìˆì„ ê²½ìš° ì˜ˆì•½ ëŒ€ê¸°ë¥¼ í•  ìˆ˜ ìˆìœ¼ë©° ë‹¤ë¥¸ ì˜ˆì•½ìê°€ ì˜ˆì•½ì„ ì·¨ì†Œí•  ê²½ìš° ê°€ì¥ ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ ì˜ˆì•½ ëŒ€ê¸°ìê°€ ì˜ˆì•½í•  í•  ìˆ˜ ìˆëŠ” ê²°ì œ ëŒ€ê¸° ìƒíƒœê°€ ë©ë‹ˆë‹¤.

### ê²°ì œ ëŒ€ê¸°

ë‚´ ì˜ˆì•½ ëª©ë¡ì— ê²°ì œ ëŒ€ê¸°ì¸ ìƒíƒœì—ì„œ ê²°ì œ ë²„íŠ¼ì„ ëˆŒëŸ¬ ê²°ì œë¥¼ í•˜ê²Œ ë˜ë©´ ì™„ì „í•œ ì˜ˆì•½ ìƒíƒœë¡œ ë³€í•˜ê²Œ ë©ë‹ˆë‹¤.

### ì˜ˆì•½ ì·¨ì†Œ

ì•„ì§ ì‹œì‘ ë˜ì§€ ì•ŠëŠ” ë°©íƒˆì¶œ ì˜ˆì•½ì— ëŒ€í•´ì„œëŠ” 1ì´ˆ ì „ê¹Œì§€ ì—ì•½ ì·¨ì†Œê°€ ê°€ëŠ¥í•˜ë©° ë³„ë„ì˜ ìœ„ì•½ê¸ˆì´ë‚˜ ìˆ˜ìˆ˜ë£ŒëŠ” ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

## ğŸ‘·ğŸ» ê´€ë¦¬ì

ê´€ë¦¬ìëŠ” ì›í•˜ëŠ” ì†ë‹˜ ì •ë³´ë¡œ ì˜ˆì•½ì„ ì¶”ê°€í•  ìˆ˜ ìˆìœ¼ë©° ëª¨ë“  ì˜ˆì•½ ì •ë³´ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê´€ë¦¬ìëŠ” í…Œë§ˆ, ì‹œê°„ì„ ì¶”ê°€í•  ìˆ˜ ìˆê³ , ì•„ë¬´ëŸ° ì˜ˆì•½ì´ ë˜ì–´ ìˆì§€ ì•Šì€ í…Œë§ˆë‚˜ ì‹œê°„ì„ ì‚­ì œí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

## ğŸ§ª Test Account

| ê¶Œí•œ  | ì´ë©”ì¼                | ë¹„ë°€ë²ˆí˜¸       |
|-----|--------------------|------------|
| ìœ ì €  | `clover@gmail.com` | `password` |
| ì–´ë“œë¯¼ | `admin@gmail.com`  | `password` |

## ğŸ“‘ API Docs

https://escape.womosoft.com/swagger-ui/index.html

## ğŸ”€ ERD

```mermaid
erDiagram
    MEMBER {
        bigint id PK
        varchar email
        varchar name
        varchar password
        varchar role
    }

    MEMBER_RESERVATION {
        timestamp created_at
        bigint id PK
        bigint member_id FK
        bigint reservation_id FK
        varchar status
    }

    RESERVATION {
        date date
        bigint id PK
        bigint theme_id FK
        bigint time_id FK
    }

    RESERVATION_TIME {
        time start_at
        bigint id PK
    }

    THEME {
        bigint id PK
        varchar description
        varchar name
        varchar thumbnail
    }

    PAYMENT {
        numeric amount
        timestamp created_at
        bigint id PK
        bigint member_reservation_id FK
        varchar order_id
        varchar payment_key
    }

    MEMBER ||--o{ MEMBER_RESERVATION: "makes"
    MEMBER_RESERVATION ||--o{ RESERVATION: "is for"
    RESERVATION ||--o{ THEME: "features"
    RESERVATION ||--o{ RESERVATION_TIME: "at time"
    MEMBER_RESERVATION ||--o{ PAYMENT: "is paid by"
```

## ğŸ”§ Setting files

### /etc/systemd/system/roomescape.service

- `sudo systemctl stop roomescape`
- `sudo systemctl start roomescape`

```ini
[Unit]
Description=Roomescape
After=network.target

[Service]
User=ubuntu
Group=nogroup
ExecStart=/usr/bin/java -jar /home/ubuntu/spring-roomescape-payment/run.jar
Restart=always

[Install]
WantedBy=multi-user.target
```

### /etc/nginx/sites-available/escape

- `sudo systemctl stop nginx`
- `sudo systemctl start nginx`

```
server {
        listen 80;
        server_name escape.womosoft.com;
        return 301 https://$server_name$request_uri;
}

server {
        listen 443;
        server_name escape.womosoft.com;

        ssl_certificate /etc/letsencrypt/live/womosoft.com/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/womosoft.com/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/womosoft.com/chain.pem;
        ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;
        ssl_session_timeout 10m;
        ssl_session_cache shared:SSL:10m;
        ssl_session_tickets off;

        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_prefer_server_ciphers on;
        ssl_ciphers TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256;
        ssl_ecdh_curve secp384r1;

        add_header Strict-Transport-Security max-age=31536000;
        add_header X-Content-Type-Options "nosniff" always;
        add_header X-Frame-Options "SAMEORIGIN" always;
        add_header X-XSS-Protection "1; mode=block" always;

        ssl_stapling on;
        ssl_stapling_verify on;

        location / {
                proxy_pass http://127.0.0.1:8080;
        }
}
```
