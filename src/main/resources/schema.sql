CREATE TABLE IF NOT EXISTS member (
    id       BIGINT       GENERATED BY DEFAULT AS IDENTITY,
    name     VARCHAR(255) NOT NULL,
    email     VARCHAR(255) NOT NULL UNIQUE,
    password  VARCHAR(255) NOT NULL,
    role VARCHAR(255) NOT NULL CHECK (role IN ('USER','ADMIN')),
    PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS reservation_time (
    id       BIGINT       GENERATED BY DEFAULT AS IDENTITY,
    start_at TIME NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS theme (
    id          BIGINT       GENERATED BY DEFAULT AS IDENTITY,
    name        VARCHAR(255) NOT NULL UNIQUE,
    description VARCHAR(255) NOT NULL,
    thumbnail   VARCHAR(255) NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS reservation (
    id       BIGINT        GENERATED BY DEFAULT AS IDENTITY,
    date     DATE NOT NULL,
    status VARCHAR(255) NOT NULL CHECK (status IN ('SUCCESS','CANCEL','WAIT','PENDING')),
    member_id BIGINT NOT NULL,
    time_id  BIGINT NOT NULL,
    theme_id BIGINT NOT NULL,
    created_at TIMESTAMP NOT NULL default CURRENT_TIMESTAMP,
    PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS payment
(
    id           BIGINT GENERATED BY DEFAULT AS IDENTITY,
    payment_key  VARCHAR(255) NOT NULL UNIQUE,
    order_id     VARCHAR(255) NOT NULL UNIQUE,
    total_amount NUMERIC       NOT NULL,
    status VARCHAR(255) NOT NULL CHECK (status IN ('READY','DONE','CANCELED','REJECTED')),
    reservation_id BIGINT NOT NULL UNIQUE,
    PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS payment_request
(
    id BIGINT GENERATED BY DEFAULT AS identity,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    message VARCHAR(255),
    payment_key VARCHAR(255) NOT NULL,
    status VARCHAR(255) NOT NULL CHECK (status IN ('READY','PAY_REQUEST','PAY_CONFIRMED','PAY_REJECTED','CANCEL_REQUEST','CANCEL_CONFIRMED','CANCEL_REJECTED')),
    PRIMARY KEY (id)
);
